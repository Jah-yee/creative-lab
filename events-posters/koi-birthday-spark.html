<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday, Koi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000;
            color: #fff;
            font-family: 'Courier New', monospace;
            overflow: hidden;
            cursor: crosshair;
        }

        #canvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1;
        }

        .container {
            position: relative;
            z-index: 2;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            pointer-events: none;
        }

        .main-text {
            text-align: center;
            opacity: 0;
            animation: fadeIn 2s ease-out forwards;
            animation-delay: 1s;
        }

        .birthday-wish {
            font-size: 2.5rem;
            letter-spacing: 0.3rem;
            margin-bottom: 2rem;
            font-weight: 100;
        }

        .typewriter {
            font-size: 1.2rem;
            line-height: 1.8;
            max-width: 600px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .typewriter span {
            opacity: 0;
            animation: typeIn 0.1s ease-out forwards;
        }

        .spark-counter {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 3;
            font-size: 0.9rem;
            opacity: 0.5;
            transition: opacity 0.3s;
        }

        .spark-counter:hover {
            opacity: 1;
        }

        .instructions {
            position: fixed;
            top: 30px;
            left: 30px;
            z-index: 3;
            font-size: 0.8rem;
            opacity: 0;
            animation: fadeIn 1s ease-out forwards;
            animation-delay: 3s;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        @keyframes typeIn {
            to { opacity: 1; }
        }

        .particle {
            position: absolute;
            pointer-events: none;
            opacity: 0;
            animation: particleFade 2s ease-out forwards;
        }

        @keyframes particleFade {
            0% {
                opacity: 1;
                transform: translate(0, 0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(var(--tx), var(--ty)) scale(0.3);
            }
        }

        @media (max-width: 768px) {
            .birthday-wish {
                font-size: 1.8rem;
            }
            .typewriter {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    
    <div class="container">
        <div class="main-text">
            <h1 class="birthday-wish">HAPPY BIRTHDAY, KOI</h1>
            <div class="typewriter" id="typewriter"></div>
        </div>
    </div>

    <div class="instructions">click to create sparks</div>
    <div class="spark-counter">sparks created: <span id="sparkCount">0</span></div>

    <script>
        // Canvas setup
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // Resize handler
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        // Particles array
        const particles = [];
        const connections = [];
        let sparkCount = 0;

        // Particle class
        class Particle {
            constructor(x, y, isUserCreated = false) {
                this.x = x;
                this.y = y;
                this.vx = (Math.random() - 0.5) * (isUserCreated ? 4 : 2);
                this.vy = (Math.random() - 0.5) * (isUserCreated ? 4 : 2);
                this.radius = isUserCreated ? 3 : 1.5;
                this.life = 1;
                this.decay = isUserCreated ? 0.01 : 0.005;
                this.isUserCreated = isUserCreated;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.life -= this.decay;
                
                // Bounce off walls
                if (this.x < 0 || this.x > canvas.width) this.vx *= -0.8;
                if (this.y < 0 || this.y > canvas.height) this.vy *= -0.8;
                
                // Friction
                this.vx *= 0.99;
                this.vy *= 0.99;
            }

            draw() {
                ctx.globalAlpha = this.life;
                ctx.fillStyle = '#fff';
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // Create initial particles
        for (let i = 0; i < 50; i++) {
            particles.push(new Particle(
                Math.random() * canvas.width,
                Math.random() * canvas.height
            ));
        }

        // Mouse/touch events
        function createSpark(e) {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX || e.touches[0].clientX;
            const y = e.clientY || e.touches[0].clientY;
            
            for (let i = 0; i < 10; i++) {
                particles.push(new Particle(x, y, true));
            }
            
            sparkCount++;
            document.getElementById('sparkCount').textContent = sparkCount;
            
            // Create visual spark effect
            const spark = document.createElement('div');
            spark.className = 'particle';
            spark.style.left = x + 'px';
            spark.style.top = y + 'px';
            spark.style.setProperty('--tx', (Math.random() - 0.5) * 100 + 'px');
            spark.style.setProperty('--ty', (Math.random() - 0.5) * 100 + 'px');
            spark.innerHTML = '✦';
            document.body.appendChild(spark);
            
            setTimeout(() => spark.remove(), 2000);
        }

        canvas.addEventListener('click', createSpark);
        canvas.addEventListener('touchstart', createSpark);

        // Animation loop
        function animate() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Update and draw particles
            particles.forEach((particle, index) => {
                particle.update();
                particle.draw();
                
                if (particle.life <= 0) {
                    particles.splice(index, 1);
                }
            });
            
            // Draw connections
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
            ctx.lineWidth = 0.5;
            
            for (let i = 0; i < particles.length; i++) {
                for (let j = i + 1; j < particles.length; j++) {
                    const dx = particles[i].x - particles[j].x;
                    const dy = particles[i].y - particles[j].y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < 100) {
                        ctx.globalAlpha = (1 - distance / 100) * 0.3;
                        ctx.beginPath();
                        ctx.moveTo(particles[i].x, particles[i].y);
                        ctx.lineTo(particles[j].x, particles[j].y);
                        ctx.stroke();
                    }
                }
            }
            
            // Maintain minimum particles
            if (particles.length < 30) {
                particles.push(new Particle(
                    Math.random() * canvas.width,
                    Math.random() * canvas.height
                ));
            }
            
            requestAnimationFrame(animate);
        }

        animate();

        // Typewriter effect
        const messages = [
            "To a tinkerer who finds beauty in simplicity,",
            "who weaves connections between 0s and 1s and human hearts,",
            "who sees sparks where others see static.",
            "",
            "May your year ahead be filled with:",
            "• Moments of profound individuality",
            "• Code that writes poetry",
            "• Questions that matter more than answers",
            "• Love that transcends logic",
            "",
            "Happy Birthday, Koi.",
            "Keep creating those beautiful sparks."
        ];

        const typewriter = document.getElementById('typewriter');
        let messageIndex = 0;
        let charIndex = 0;
        let currentLine = '';

        function typeMessage() {
            if (messageIndex < messages.length) {
                const message = messages[messageIndex];
                
                if (charIndex < message.length) {
                    currentLine += message[charIndex];
                    const span = document.createElement('span');
                    span.textContent = message[charIndex];
                    span.style.animationDelay = `${charIndex * 0.05}s`;
                    
                    if (messageIndex >= messages.length - 2) {
                        span.style.fontWeight = 'bold';
                    }
                    
                    typewriter.appendChild(span);
                    charIndex++;
                    setTimeout(typeMessage, 50);
                } else {
                    typewriter.appendChild(document.createElement('br'));
                    messageIndex++;
                    charIndex = 0;
                    currentLine = '';
                    setTimeout(typeMessage, 300);
                }
            }
        }

        setTimeout(typeMessage, 2000);
    </script>
</body>
</html>